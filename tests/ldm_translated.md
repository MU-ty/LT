---
status: translated
title: "LDM - Logical Disk Manager (Dynamic Disks)"
author: Linux Kernel Community
collector: tttturtle-russ
collected_date: 20240718
translator: FILL_YOUR_GITHUB_ID_HERE
translating_date: 20251001
link: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/ldm.rst
---

# LDM - 逻辑磁盘管理器（动态磁盘）

作者

:   最初由 FlatCap - Richard Russon 撰写  
    \<ldm@flatcap.org\>。

最后更新

:   Anton Altaparmakov 于 2007 年 3 月 30 日针对 Windows Vista 更新。

## 概述

Windows 2000、XP 和 Vista 采用了一种新的分区方案，完全取代了 MSDOS 风格的分区。该方案在物理磁盘末尾的一个大小为 1MiB 的日志式数据库中存储其信息。分区的大小仅受磁盘空间限制，最大分区数量接近 2000 个。

在 LDM 下创建的任何分区都称为“动态磁盘”。此时不再区分主分区和扩展分区，传统的 MSDOS 风格分区现在被称为基本磁盘。

如果您希望使用跨区卷、带区卷、镜像卷或 RAID 5 卷，则必须使用动态磁盘。日志功能使得 Windows 能够在无需重启的情况下修改这些分区及其文件系统。

LDM 驱动负责划分磁盘后，可使用 MD 驱动进一步组装多分区卷，例如带区卷、RAID5 等。

为了防止旧版应用程序重新对磁盘进行分区，LDM 会创建一个虚拟的 MSDOS 分区，其中包含一个与整个磁盘大小相同的分区。Linux 的 LDM 驱动目前仅支持此模式。

Vista 引入了一种较新的方法，即将 LDM 建立在 GPT 标签磁盘之上。这一方式目前尚未被 Linux 的 LDM 驱动所支持。

## 示例

片段2:

以下是一个 50MiB 的磁盘，被划分为七个分区。

:::note
注意
:::

磁盘末尾缺失的 1MiB 空间用于存储 LDM 数据库。

片段3:

+------------+------------------+---------+-----++------------------+---------+-----+
| 偏移量（字节） | 扇区数           | MiB     |    || 大小（字节）       | 扇区数   | MiB |
+============+==================+=========+=====++==================+=========+=====+
| 0          | 0                | 0       |    || 52428800         | 102400  | 50  |
+------------+------------------+---------+-----++------------------+---------+-----+
| 51380224   | 100352           | 49      |    || 1048576          | 2048    | 1   |
+------------+------------------+---------+-----++------------------+---------+-----+
| 16384      | 32               | 0       |    || 6979584          | 13632   | 6   |
+------------+------------------+---------+-----++------------------+---------+-----+
| 6995968    | 13664            | 6       |    || 10485760         | 20480   | 10  |
+------------+------------------+---------+-----++------------------+---------+-----+
| 17481728   | 34144            | 16      |    || 4194304          | 8192    | 4   |
+------------+------------------+---------+-----++------------------+---------+-----+
| 21676032   | 42336            | 20      |    || 5242880          | 10240   | 5   |
+------------+------------------+---------+-----++------------------+---------+-----+
| 26918912   | 52576            | 25      |    || 10485760         | 20480   | 10  |
+------------+------------------+---------+-----++------------------+---------+-----+
| 37404672   | 73056            | 35      |    || 13959168         | 27264   | 13  |
+------------+------------------+---------+-----++------------------+---------+-----+

LDM 数据库可能不会按照磁盘上的实际顺序存储分区信息，但驱动程序会自动将其排序。

片段4:

当 Linux 启动时，您将看到类似如下信息：

    hda: 102400 sectors w/32KiB Cache, CHS=50/64/32
    hda: [LDM] hda1 hda2 hda3 hda4 hda5 hda6 hda7

## 编译 LDM 支持

要启用 LDM，请选择以下两个选项：

> -   "高级分区选择" CONFIG_PARTITION_ADVANCED  
> -   "Windows 逻辑磁盘管理器（动态磁盘）支持"  
>     CONFIG_LDM_PARTITION

如果你认为驱动程序未能正常工作，可以启用额外的调试代码。这将产生大量输出。该选项为：

> -   "Windows LDM 额外日志记录" CONFIG_LDM_DEBUG

注意：此分区代码不能编译为模块。

与所有分区代码一样，如果驱动程序未检测到其对应的分区类型，它会将控制权交给其他驱动程序，因此启用该功能没有任何风险。

如果你使用的是动态磁盘但未启用该驱动程序，那么你只能看到一个填满整个磁盘的虚拟 MSDOS 分区，无法挂载磁盘上的任何卷。

## 启动

如果你启用了 LDM 支持，lilo 能够从发现的任意分区启动。然而，grub 无法识别 LDM 分区结构，因此不能从动态磁盘启动。

## 更多文档

有关 LDM 的概述以及完整的技术文档可供下载。

> <http://www.linux-ntfs.org/>

如果你有任何在文档中未解答的 LDM 相关问题，请发送邮件给我。

此致，

:   FlatCap - Richard Russon <ldm@flatcap.org>